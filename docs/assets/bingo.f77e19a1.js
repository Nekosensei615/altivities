import{d as G,e as W,r as J,f as K,o as u,c as b,g as _,w as k,h as o,u as s,i as O,j as R,F as g,k as P,l as Q,m as X,n as h,p as x,q as C,t as z,S as B,s as N,a as Y,b as Z}from"./pinia.esm-browser.14892411.js";import{_ as A,i as V,z as ee}from"./QRToggle.d3f2701f.js";import{d as te,_ as L}from"./CardsMenu.fecbcab0.js";import{u as w}from"./url.ba275dec.js";import{u as F}from"./wordlist.b4e8ec7e.js";import{r as U}from"./random.9fb4bc4f.js";var se="/assets/images/bingo_circle.png";const j=G({id:"bingo",state:()=>({cellSize:0,cols:3,rows:3,mode:"set",ready:!1,selected:new Array,marked:new Array}),actions:{calculateCellSize(){const a=window.innerWidth-16,t=window.innerHeight-160;return this.cellSize=Math.min(a/this.cols,t/this.rows),this.cellSize},checkReady(){var n;const a=[];let t=!0,e=!1;for(let d=0;d<this.cols*this.rows;d++){const m=(n=this.selected[d][0])==null?void 0:n.id;m===void 0?t=!1:e=!0,a.push(m!=null?m:"")}return e?w("bingo",a.join(",")):w("bingo",void 0),this.ready=t,t},countBingos(){let a=0;if(this.cols>1)for(let t=0;t<this.rows;t++){let e=!0;for(let n=0;n<this.cols;n++){const d=t*this.cols+n;if(!this.marked[d]){e=!1;break}}e&&(a+=1)}if(this.rows>1)for(let t=0;t<this.cols;t++){let e=!0;for(let n=0;n<this.rows;n++){const d=n*this.cols+t;if(!this.marked[d]){e=!1;break}}e&&(a+=1)}if(this.cols==this.rows){let t=!0,e=!0;for(let n=0;n<this.cols;n++){const d=n*this.cols+n,m=(n+1)*this.cols-(n+1);this.marked[d]||(t=!1),this.marked[m]||(e=!1)}t&&(a+=1),e&&(a+=1)}return a},resetMarked(){this.marked.splice(0,this.marked.length);for(let a=0;a<this.rows*this.cols;a++)this.marked.push(!1)},resetStore(){w("bingo",void 0),this.marked.splice(0,this.marked.length),this.selected.splice(0,this.selected.length);for(let a=0;a<this.rows*this.cols;a++)this.selected.push([]),this.marked[a]=!1;this.calculateCellSize(),this.checkReady()},setSettingsFromURLSearchParams(){const a=new URLSearchParams(window.location.search),t=a.get("rows");t&&(this.rows=Number.parseInt(t));const e=a.get("cols");e&&(this.cols=Number.parseInt(e));for(let n=0;n<this.rows*this.cols;n++)this.selected.push([]),this.marked[n]=!1;this.calculateCellSize()}}});const oe=["onSubmit"],ne=P(" # Rows "),le=["value"],ie=P(" # Columns "),ae=["value"],re=o("input",{type:"submit",value:"Set"},null,-1),M=W({name:"BingoSettingsToggle",setup(a){let t=J(!1);const e=j(),n=F();function d(){const m=Number.parseInt(document.querySelector('input[name="rows"]').value),f=Number.parseInt(document.querySelector('input[name="cols"]').value);e.rows=m,e.cols=f,w("rows",m.toString()),w("cols",f.toString()),e.mode="set",n.resetStore(),e.resetStore(),t.value=!1}return(m,f)=>{const v=K("vue-final-modal");return u(),b(g,null,[_(v,{modelValue:s(t),"onUpdate:modelValue":f[0]||(f[0]=y=>R(t)?t.value=y:t=y),classes:"modal-container","content-class":"modal-content"},{default:k(()=>[o("form",{class:"how-many-settings-form",onSubmit:O(d,["prevent"]),name:"type"},[ne,o("input",{type:"number",id:"rows",name:"rows",value:s(e).rows},null,8,le),ie,o("input",{type:"number",id:"cols",name:"cols",value:s(e).cols},null,8,ae),re],40,oe)]),_:1},8,["modelValue"]),o("span",{class:"material-symbols-outlined button button-top button-left-2 settings-button",onClick:f[1]||(f[1]=y=>R(t)?t.value=!0:t=!0)},"settings")],64)}}});const ce={id:"top"},de=o("span",{class:"material-symbols-outlined handle"},"drag_handle",-1),ue={id:"top"},me=["onClick","id"],he={id:"top"},pe={class:"large-card"},be=o("span",{class:"material-symbols-outlined handle"},"drag_handle",-1),fe={class:"text"},ge=W({name:"BingoApp",setup(a){const t=F(),e=j();Q(t.wordLists,()=>{const c=new URLSearchParams(window.location.search).get("bingo");if(c){const l=c.split(",");for(let i=0;i<l.length;i++){const p=l[i];if(p==="")continue;const H=Number.parseInt(p),$=t.selectWord(H);if(!$)continue;const I=e.selected[i];if(!I)break;I.push($)}}e.checkReady()}),e.setSettingsFromURLSearchParams();function n(r,c,l=2){const i=[l,l,l,l];return r==1&&e.rows!==1?i[0]*=2:r==e.rows&&e.rows!==1&&(i[2]*=2),c==1&&e.cols!==1?i[3]*=2:c==e.cols&&e.cols!==1&&(i[1]*=2),i.join("px ")+"px"}function d(){t.resetStore(),e.resetStore()}function m(){d();for(let r=0;r<e.cols*e.rows;r++){const c=U(0,t.unselected[0].length-1),l=t.unselected[0].splice(c,1)[0];if(l==null)return;e.selected[r].push(l)}e.checkReady()}function f(){e.resetMarked(),e.checkReady()&&(e.mode="play")}function v(r){e.marked[r]=!e.marked[r]}function y(r=!1){e.mode="set",r&&d()}function q(){t.resetStore(),e.resetStore(),e.mode="teach"}function T(){if(t.unselected[0].length==0)throw"No more words to draw";const r=U(0,t.unselected[0].length-1),c=t.unselected[0].splice(r,1)[0];t.selected[0].push(c)}function D(){const r=t.selected[0].pop();!r||t.unselected[0].push(r)}const E=r=>{const c=Number.parseInt(r.from.id.split("_")[1]),l=Number.parseInt(r.to.id.split("_")[1]);if(e.selected[l].length>1){const i=e.selected[l].splice(r.newIndex?0:1,1)[0];Number.isNaN(c)?t.unselected[0].push(i):e.selected[c].push(i)}e.checkReady()};return X(()=>{window.addEventListener("resize",()=>{e.calculateCellSize()})}),(r,c)=>s(e).mode=="set"?(u(),b(g,{key:0},[_(A),_(M),o("span",{onClick:q,class:"material-symbols-outlined button button-top button-left-3 teach-button"}," school "),o("div",ce,[o("div",{class:"bingo",style:h({width:`${s(e).cellSize*s(e).cols}px`})},[(u(!0),b(g,null,x(s(e).rows,l=>(u(),b(g,null,[(u(!0),b(g,null,x(s(e).cols,i=>(u(),C(s(te),{onAdd:E,onRemove:s(e).checkReady,animation:"200",class:"bingo-cell",easing:"cubic-bezier(0.34, 1.56, 0.64, 1)",group:"words",id:`cell_${(l-1)*s(e).cols+(i-1)}`,"item-key":"id",modelValue:s(e).selected[(l-1)*s(e).cols+(i-1)],"onUpdate:modelValue":p=>s(e).selected[(l-1)*s(e).cols+(i-1)]=p,key:l*s(e).cols+i,style:h({borderWidth:n(l,i,2),height:s(e).cellSize+"px",width:s(e).cellSize+"px"})},{item:k(({element:p})=>[o("div",{class:"card",style:h({backgroundImage:`url(${p.image})`})},[de,o("span",{class:"text",style:h({"font-size":s(e).cellSize/10+"px"})},z(Array.isArray(p.en)?p.en[0]:p.en),5)],4)]),_:2},1032,["onRemove","id","modelValue","onUpdate:modelValue","style"]))),128))],64))),256))],4)]),o("span",{onClick:d,class:"button button-bottom button-left-1 restart-button material-symbols-outlined"}," restart_alt "),o("span",{onClick:m,class:"button button-bottom button-left-2 shuffle-button material-symbols-outlined"}," shuffle "),o("span",{onClick:f,class:"button button-bottom button-right-1 ready-button material-symbols-outlined",style:h({color:s(e).ready?"green":"black",cursor:s(e).ready?"pointer":"not-allowed",opacity:s(e).ready?1:void 0})}," thumb_up ",4),(u(),C(B,null,{default:k(()=>[_(L)]),_:1}))],64)):s(e).mode=="play"?(u(),b(g,{key:1},[o("div",ue,[o("div",{class:"bingo",style:h({width:`${s(e).cellSize*s(e).cols}px`})},[(u(!0),b(g,null,x(s(e).selected,(l,i)=>(u(),b("div",{onClick:p=>v(i),class:"bingo-cell",key:i,id:`cell_${i}`,style:h({borderWidth:n(Math.floor(i/s(e).cols)+1,i%s(e).cols+1,2),height:s(e).cellSize+"px",width:s(e).cellSize+"px"})},[o("img",{src:se,style:h({opacity:s(e).marked[i]?.6:0})},null,4),o("div",{class:"card",style:h({backgroundImage:`url(${l[0].image})`})},[o("span",{class:"text",style:h({"font-size":s(e).cellSize/10+"px"})},z(Array.isArray(l[0].en)?l[0].en[0]:l[0].en),5)],4)],12,me))),128))],4)]),o("span",{onClick:c[0]||(c[0]=l=>y(!1)),class:"button button-bottom button-left-1 restart-button material-symbols-outlined"}," arrow_back ")],64)):s(e).mode=="teach"?(u(),b(g,{key:2},[_(A),_(M),o("div",he,[o("div",pe,[s(t).selected[0].length?(u(),b("div",{key:0,style:h({backgroundImage:`url(${s(t).selected[0][s(t).selected[0].length-1].image})`})},[be,o("span",fe,z(Array.isArray(s(t).selected[0][s(t).selected[0].length-1].en)?s(t).selected[0][s(t).selected[0].length-1].en[0]:s(t).selected[0][s(t).selected[0].length-1].en),1)],4)):N("",!0)])]),o("span",{onClick:c[1]||(c[1]=l=>y(!0)),class:"button button-bottom button-left-1 back-button material-symbols-outlined"}," arrow_back "),o("span",{onClick:d,class:"button button-bottom button-left-2 restart-button material-symbols-outlined"}," restart_alt "),o("span",{onClick:D,class:"button button-bottom button-right-2 undo-button material-symbols-outlined"}," undo "),o("span",{onClick:T,class:"button button-bottom button-right-1 random-button material-symbols-outlined"}," casino "),(u(),C(B,null,{default:k(()=>[_(L)]),_:1}))],64)):N("",!0)}}),S=Y(ge);S.component(V.name,V);S.use(Z());S.use(ee);S.mount("#app");
